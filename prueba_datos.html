<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - VISTA PREVIA (DATOS SIMULADOS)</title>
    
    <link rel="stylesheet" href="style.css"> 
</head>
<body>

    <div id="dashboard-content" style="display: block;">
    
        <div class="header">
            <h1>ðŸ“Š Panel de Control del Chatbot</h1>
            <button id="logout-btn">Cerrar SesiÃ³n</button>
        </div>
        
        <div id="status-bar">
            Estado: <span id="message">Vista previa de datos simulados</span>
        </div>

        <div class="card" style="border-left-color: #3498db;">
            <h3>ðŸ“ˆ MÃ©tricas Clave</h3>
            <p class="metric">Pedidos Cargados: <span id="pedidos-count" style="font-weight: bold; color: #00fff2;">0</span></p>
        </div>

        <div class="data-grid">
            
            <div class="card">
                <h3>ðŸ›’ Ãšltimos Pedidos</h3>
                <ul id="pedidos-list">
                    <li>Cargando pedidos simulados...</li>
                </ul>
            </div>
            
            <div class="card" style="border-left-color: #00fff2;">
                <h3>ðŸ’¬ Logs de ConversaciÃ³n Reciente</h3>
                <ul id="conversacion-list">
                    <li>Cargando logs simulados...</li>
                </ul>
            </div>
            
        </div>
        
    </div> 

    <script>
        // ----------------------------------------------------------------------
        // 1. DATOS SIMULADOS (JSON que vendrÃ­a de Supabase)
        // ----------------------------------------------------------------------

        // A. SIMULACIÃ“N DE PEDIDOS (Se simulan 3)
        const mockPedidos = [
            {
                id: 105,
                producto_servicio: "InstalaciÃ³n de Fibra Ã“ptica (Plan Premium)",
                monto: 59.99,
                estado: "Pendiente",
                fecha_pedido: "2025-11-28T09:30:00Z",
                clientes: { nombre: "Andrea GarcÃ­a", numero_whatsapp: 5491155551234 }
            },
            {
                id: 104,
                producto_servicio: "Recarga de Saldo (5GB)",
                monto: 15.00,
                estado: "Completado",
                fecha_pedido: "2025-11-27T18:45:00Z",
                clientes: { nombre: "Ricardo Perez", numero_whatsapp: 5491166665678 }
            },
            {
                id: 103,
                producto_servicio: "Soporte TÃ©cnico Nivel 2",
                monto: 0.00,
                estado: "En proceso",
                fecha_pedido: "2025-11-27T10:15:00Z",
                clientes: { nombre: "Javier LÃ³pez", numero_whatsapp: 5491177779012 }
            }
        ];

        // B. SIMULACIÃ“N DE CONVERSACIÃ“N (Se simulan 5 interacciones)
        const mockLogs = [
            {
                es_entrada: true, // Cliente -> Bot
                contenido: "SÃ­, por favor, agendemos la instalaciÃ³n de la fibra para el martes por la maÃ±ana.",
                chatbot_accion: "ConfirmaciÃ³n de Cita",
                created_at: "2025-11-28T10:05:00Z"
            },
            {
                es_entrada: false, // Bot -> Cliente
                contenido: "Perfecto, Andrea. Su solicitud de instalaciÃ³n ha sido registrada. Â¿Desea confirmar la cita para el martes 3/12 a las 9:00 AM?",
                chatbot_accion: "Solicitar ConfirmaciÃ³n",
                created_at: "2025-11-28T10:04:00Z"
            },
            {
                es_entrada: true, // Cliente -> Bot
                contenido: "Quiero el plan de Fibra Ã“ptica Premium.",
                chatbot_accion: "SelecciÃ³n de Plan",
                created_at: "2025-11-28T09:45:00Z"
            },
            {
                es_entrada: false, // Bot -> Cliente
                contenido: "Claro, Â¿quÃ© tipo de asistencia necesita? Por favor, escriba '1' para Internet o '2' para MÃ³vil.",
                chatbot_accion: "MenÃº Principal",
                created_at: "2025-11-28T09:40:00Z"
            },
            {
                es_entrada: true, // Cliente -> Bot
                contenido: "hola necesito ayuda con la instalaciÃ³n",
                chatbot_accion: "Inicio de ConversaciÃ³n",
                created_at: "2025-11-28T09:35:00Z"
            }
        ];
        
        // ----------------------------------------------------------------------
        // 2. LÃ“GICA DE CARGA (Funciona como una versiÃ³n simplificada de dashboard.js)
        // ----------------------------------------------------------------------

        document.addEventListener('DOMContentLoaded', () => {
            const pedidosList = document.getElementById('pedidos-list');
            const pedidosCount = document.getElementById('pedidos-count');
            const conversacionList = document.getElementById('conversacion-list');

            // --- Carga de Pedidos ---
            pedidosCount.textContent = mockPedidos.length; 
            pedidosList.innerHTML = ''; 
            
            mockPedidos.forEach(p => {
                const listItem = document.createElement('li');
                const clientName = p.clientes.nombre || `+${p.clientes.numero_whatsapp}`;
                // Formateo simple de fecha (sin librerÃ­as, solo para la prueba)
                const date = new Date(p.fecha_pedido).toLocaleDateString('es-ES');
                
                listItem.innerHTML = `
                    <span style="font-weight: bold;">[${p.estado}]</span> ${p.producto_servicio} (${p.monto}â‚¬)<br>
                    <small>Cliente: ${clientName} - ${date}</small>
                `;
                pedidosList.appendChild(listItem);
            });

            // --- Carga de Logs ---
            conversacionList.innerHTML = '';
            mockLogs.forEach(log => {
                const direction = log.es_entrada ? 'Cliente' : 'Bot';
                // Usamos los colores de neÃ³n definidos en style.css para diferenciar
                const style = log.es_entrada ? 'font-weight: bold; color: #00fff2;' : 'color: #c501e2;';

                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <span style="${style}">${direction}</span>: ${log.contenido.substring(0, 70)}...<br>
                    <small>(${log.chatbot_accion || 'Mensaje'})</small>
                `;
                conversacionList.appendChild(listItem);
            });
        });

    </script>
</body>
</html>
